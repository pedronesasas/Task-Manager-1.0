<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Tarefas - UI/UX Front-end</title>
    
    <!-- Fonte Inter (Google Fonts) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configurações Customizadas do Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        gray: {
                            50: '#F9FAFB',
                            100: '#F3F4F6',
                            200: '#E5E7EB',
                            300: '#D1D5DB',
                            400: '#9CA3AF',
                            500: '#6B7280',
                            600: '#4B5563',
                            800: '#1F2937',
                            900: '#111827',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos customizados para o Checkbox */
        .custom-checkbox {
            appearance: none;
            background-color: #fff;
            margin: 0;
            font: inherit;
            color: currentColor;
            width: 1.25em;
            height: 1.25em;
            border: 2px solid #D1D5DB;
            border-radius: 0.375rem; /* rounded-md */
            display: grid;
            place-content: center;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }

        .custom-checkbox::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 0.2s transform ease-in-out;
            box-shadow: inset 1em 1em white;
            transform-origin: center;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }

        .custom-checkbox:checked {
            background-color: #2563EB; /* blue-600 */
            border-color: #2563EB;
        }

        .custom-checkbox:checked::before {
            transform: scale(1);
        }

        .custom-checkbox:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            box-shadow: 0 0 0 2px #BFDBFE; /* blue-200 ring */
        }

        /* Animação de entrada da lista */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Destaque ao adicionar nova tarefa */
        @keyframes highlight {
            from { background-color: #eff6ff; }
            to { background-color: transparent; }
        }
        .highlight {
            animation: highlight 0.6s ease-out;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans text-gray-800 antialiased flex items-center justify-center p-4 sm:p-8">

    <!-- Main Container -->
    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-xl shadow-gray-200/50 overflow-hidden border border-gray-100 flex flex-col max-h-[85vh]">
        
        <!-- Header -->
        <div class="px-6 py-6 border-b border-gray-100 flex justify-between items-center bg-white z-10 relative flex-shrink-0">
            <div>
                <h1 class="text-2xl font-bold text-gray-900 tracking-tight">Minhas Tarefas</h1>
                <p class="text-sm text-gray-500 mt-1">Gestão rápida, foco total no que importa.</p>
            </div>
            <div class="bg-blue-50 text-blue-700 text-xs font-semibold px-3 py-1 rounded-full border border-blue-100">
                <span id="task-count">5</span> Pendentes
            </div>
        </div>

        <!-- Quick Add Input Section -->
        <div class="px-6 py-4 bg-gray-50/50 border-b border-gray-100 flex-shrink-0">
            <div class="relative">
                <input 
                    type="text" 
                    id="new-task-input"
                    placeholder="Título ; Prazo ; Prioridade ; Detalhes (Pressione Enter)"
                    class="w-full pl-4 pr-12 py-3 text-sm bg-white border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 transition-all placeholder-gray-400"
                >
                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-400 border border-gray-200 rounded px-1.5 py-0.5 hidden sm:block">
                    Enter
                </div>
            </div>
            <p class="text-[10px] text-gray-400 mt-2 pl-1">
                <span class="font-bold text-gray-500">Dica:</span> Use <code class="bg-gray-200 px-1 rounded">;</code> para separar. Ex: <span class="italic">Reunião ; 14h ; Alta ; Sala 2</span>
            </p>
        </div>

        <!-- Task List Container -->
        <div id="task-list" class="divide-y divide-gray-50 overflow-y-auto custom-scrollbar flex-grow bg-white">
            <!-- As tarefas serão inseridas aqui via JavaScript -->
        </div>

        <!-- Footer (Visual Only) -->
        <div class="bg-gray-50 px-6 py-4 text-center text-xs text-gray-400 border-t border-gray-100 flex-shrink-0">
            Clique no card ou no checkbox para concluir. Use o “x” para remover.
        </div>
    </div>

    <script>
        // --- Dados (Mock Data) ---
        let initialTasks = [
            {
                id: 145,
                title: 'Escrever fluxo da black friday',
                deadline: '10/11',
                priority: 'Urgente',
                detail: 'Aguardar Vini aprovar o copy',
                completed: false
            },
            {
                id: 146,
                title: 'Revisar protótipo Figma',
                deadline: '12/11',
                priority: 'Alta',
                detail: 'Focar na tela de Checkout',
                completed: false
            },
            {
                id: 147,
                title: 'Atualizar bibliotecas do projeto',
                deadline: '15/11',
                priority: 'Normal',
                detail: 'React e Tailwind',
                completed: true
            },
            {
                id: 148,
                title: 'Reunião de alinhamento Q4',
                deadline: '16/11',
                priority: 'Normal',
                detail: 'Preparar slides de métricas',
                completed: false
            },
            {
                id: 149,
                title: 'Corrigir bug de renderização Safari',
                deadline: '10/11',
                priority: 'Urgente',
                detail: 'Issue #402 no GitHub',
                completed: false
            }
        ];

        // --- Estado auxiliar ---
        let lastAddedTaskId = null;

        // --- Elementos ---
        const taskListElement = document.getElementById('task-list');
        const taskCountElement = document.getElementById('task-count');
        const newTaskInput = document.getElementById('new-task-input');

        // --- Ícones ---
        const icons = {
            clock: `
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            `,
            trash: `
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6l-1 14H6L5 6"></path>
                    <path d="M10 11v6"></path>
                    <path d="M14 11v6"></path>
                    <path d="M9 6l1-2h4l1 2"></path>
                </svg>
            `
        };

        const priorityStyles = {
            'Urgente': 'bg-red-50 text-red-600 border-red-100',
            'Alta': 'bg-amber-50 text-amber-600 border-amber-100',
            'Normal': 'bg-blue-50 text-blue-600 border-blue-100',
            'Baixa': 'bg-gray-50 text-gray-600 border-gray-200'
        };

        // --- Utilitários ---
        function normalizePriority(priority) {
            if (!priority) return 'Normal';
            const formatted = priority.charAt(0).toUpperCase() + priority.slice(1).toLowerCase();
            return ['Urgente', 'Alta', 'Normal', 'Baixa'].includes(formatted) ? formatted : 'Normal';
        }

        // --- Lógica Principal ---

        newTaskInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const text = newTaskInput.value.trim();
                if (text) {
                    addNewTask(text);
                    newTaskInput.value = ''; 
                }
            }
        });

        function addNewTask(inputString) {
            const parts = inputString.split(';').map(part => part.trim());
            const title = parts[0];
            const deadline = parts[1] || 'Hoje';
            let priority = parts[2] || 'Normal';
            const detail = parts[3] || '';

            if (!title) return;

            priority = normalizePriority(priority);

            const newTask = {
                id: Date.now(),
                title: title,
                deadline: deadline,
                priority: priority,
                detail: detail,
                completed: false
            };

            lastAddedTaskId = newTask.id;
            initialTasks.unshift(newTask);
            renderTasks();
        }

        function renderTasks() {
            taskListElement.innerHTML = '';
            let pendingCount = 0;

            if (initialTasks.length === 0) {
                taskListElement.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-40 text-gray-400 text-sm">
                        <p>Nenhuma tarefa pendente.</p>
                        <p class="text-xs mt-1">Adicione novas tarefas acima.</p>
                    </div>
                `;
                taskCountElement.textContent = 0;
                return;
            }

            // Ordenação: não concluídas primeiro, depois por prioridade
            const priorityOrder = { 'Urgente': 1, 'Alta': 2, 'Normal': 3, 'Baixa': 4 };
            const sortedTasks = [...initialTasks].sort((a, b) => {
                const completedDiff = (a.completed === b.completed) ? 0 : (a.completed ? 1 : -1);
                if (completedDiff !== 0) return completedDiff;
                const pa = priorityOrder[a.priority] || 99;
                const pb = priorityOrder[b.priority] || 99;
                if (pa !== pb) return pa - pb;
                return a.id - b.id;
            });

            const fragment = document.createDocumentFragment();

            sortedTasks.forEach((task, index) => {
                if (!task.completed) pendingCount++;

                const row = document.createElement('div');
                
                let rowClasses = 'group flex flex-col sm:flex-row items-start sm:items-center gap-4 p-5 hover:bg-gray-50 transition-all duration-300 ease-in-out cursor-pointer select-none animate-fade-in border-l-4 border-transparent';
                
                if (task.completed) {
                    rowClasses += ' opacity-50 grayscale bg-gray-50/50 scale-[0.98]'; 
                } else {
                    rowClasses += ' bg-white hover:shadow-sm hover:border-blue-500';
                }

                row.className = rowClasses;
                row.style.animationDelay = `${Math.min(index * 50, 500)}ms`;

                // Acessibilidade
                row.setAttribute('role', 'button');
                row.setAttribute('aria-pressed', task.completed ? 'true' : 'false');

                // Destaque se for a última adicionada
                if (task.id === lastAddedTaskId) {
                    row.classList.add('highlight');
                }

                row.onclick = (e) => {
                    const isCheckbox = e.target.closest('input[type="checkbox"]');
                    const isButton = e.target.closest('button');
                    if (isCheckbox || isButton) return;
                    toggleTask(task.id);
                };

                row.innerHTML = `
                    <div class="flex items-center gap-4 flex-1 w-full">
                        <div class="relative flex items-center">
                            <input 
                                type="checkbox" 
                                class="custom-checkbox focus:ring-2 focus:ring-offset-2 focus:ring-blue-100"
                                ${task.completed ? 'checked' : ''}
                                aria-label="Marcar tarefa ${task.title}"
                                onclick="event.stopPropagation(); toggleTask(${task.id});"
                            >
                        </div>
                        <span class="hidden sm:inline-flex items-center justify-center px-2 py-0.5 rounded text-[10px] font-medium bg-gray-100 text-gray-500 border border-gray-200 font-mono">
                            #${task.id.toString().slice(-3)}
                        </span>
                        <div class="flex flex-col min-w-0">
                            <span class="text-sm font-bold text-gray-800 truncate transition-all duration-300 ${task.completed ? 'line-through text-gray-500' : ''}">
                                ${task.title}
                            </span>
                            <span class="text-xs text-gray-400 truncate mt-0.5 transition-all duration-300 ${task.completed ? 'line-through' : ''} ${!task.detail ? 'hidden' : ''}">
                                ${task.detail}
                            </span>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 w-full sm:w-auto justify-between sm:justify-end pl-9 sm:pl-0">
                        <div class="flex items-center text-xs font-medium ${task.completed ? 'text-gray-400' : 'text-gray-500'}">
                            ${icons.clock}
                            ${task.deadline}
                        </div>
                        <span class="px-2.5 py-1 rounded-full text-[10px] uppercase tracking-wider font-bold border ${priorityStyles[task.priority] || priorityStyles['Normal']}">
                            ${task.priority}
                        </span>
                        <button 
                            class="delete-task opacity-0 group-hover:opacity-100 transition text-gray-300 hover:text-red-500 flex items-center justify-center"
                            aria-label="Excluir tarefa ${task.title}"
                            onclick="deleteTask(${task.id}); event.stopPropagation();"
                        >
                            ${icons.trash}
                        </button>
                    </div>
                `;

                fragment.appendChild(row);
            });

            taskListElement.appendChild(fragment);
            taskCountElement.textContent = pendingCount;
        }

        function toggleTask(id) {
            const taskIndex = initialTasks.findIndex(t => t.id === id);
            if (taskIndex > -1) {
                initialTasks[taskIndex].completed = !initialTasks[taskIndex].completed;
                renderTasks();
            }
        }

        function deleteTask(id) {
            initialTasks = initialTasks.filter(t => t.id !== id);
            if (lastAddedTaskId === id) {
                lastAddedTaskId = null;
            }
            renderTasks();
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            renderTasks();
        });

    </script>
</body>
</html>
